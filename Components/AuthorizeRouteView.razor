@using Microsoft.AspNetCore.Components.Authorization
@using CRUD_Employee_standAlone.Services
@inject AuthService AuthService
@inject NavigationManager Navigation

<CascadingAuthenticationState>
    <AuthorizeView>
        <Authorized>
            @ChildContent
        </Authorized>
        <NotAuthorized>
            @{
                Navigation.NavigateTo("/login");
            }
        </NotAuthorized>
    </AuthorizeView>
</CascadingAuthenticationState>

@code {
    [Parameter] public RenderFragment? ChildContent { get; set; }

    protected override async Task OnInitializedAsync()
    {
        var isAuthenticated = await AuthService.IsAuthenticatedAsync();
        if (!isAuthenticated && Navigation.Uri != Navigation.BaseUri + "login")
        {
            Navigation.NavigateTo("/login");
        }
    }
}